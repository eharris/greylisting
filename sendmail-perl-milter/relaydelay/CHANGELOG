
Changelog for relaydelay.pl and associated files:

UNRELEASED -

0.03 - Release

  2003-07-19 - A few cosmetic changes and comment updates.

  2003-07-15 - Added an update whereby manual whitelist entries for localhost
    and other local interface addresses are no longer necessary, as the 
    milter now considers any mail that is "looped back" on a local interface
    as being local and exempt from the greylist checks.

  2003-07-15 - Fixed a bug where mail that looks as if it is spoofed from
    a local domain was not being checked, due to sendmail lying about it 
    coming from the "local" mailer when it's really not local.

  2003-07-13 - CONFIG CHANGE - Changed the milter to have config parameters
    for the milter/sendmail interface.  Now the only option to the milter
    script is an optional config file if different from the default location.
    This also removes the requirement of modifying the milter script if the
    config is stored in a different location.

  2003-07-13 - NEW OPTION - Added a config option to limit the number of 
    threads the milter will spawn.  Once a thread is spawned it will continue
    to exist until the milter is shutdown.  Since each thread increases the
    memory footprint, and consumes a db connection, this is a good way to 
    limit both.

  2003-07-12 - Fixed a small problem where bounce messages were not properly
    expired as they should be.  Also fixed some minor warnings.

  2003-07-11 - Backed out changes for trying to fix the accounting error of
    a few days ago.  The "solution" caused more trouble  than the problem.

  2003-07-10 - NEW OPTION - Added a new feature to automatically 
    pre-whitelist recipients of locally generated outbound mail.  Mail that 
    is relayed for another IP-wildcard whitelisted host, or sent from an 
    authenticated sender is also considered local for the purposes of this 
    feature.

  2003-07-10 - Removed the table locking from the milter.  Made some changes
    to a few queries to make the ordering of returned rows deterministic.
    As a result of the removing the DB locks, there is now a very small 
    (miniscule) race condition that may allow duplicate rows to be 
    inserted into the database, but the changes to the queries makes it so
    that duplicates will not cause any noticable harm.

  2003-07-09 - Uncovered a slight accounting problem in the milter that 
    caused some rows not to be expired as they should, as well as 
    incorrectly updating the passed_count.  The problem only shows itself
    if there is another MX host forwarding for a domain.  Changed the milter
    so that we do not increment the passed count if the outmailer is not
    local (if the mail will be forwarded to another host).  This will keep
    the counts of individual emails correct (rather than relay hops), and 
    will keep records stemming from mails to invalid users from being 
    upgraded to whitelisted rather than immediately expired.

  2003-07-07 - Discovered postfix normally uses <postmaster@some.domain> for 
    its envelope from address when doing SMTP callbacks.  Changed milter to 
    treat any email from postmaster@ as a callback and delay the tempfail
    until after the DATA phase.

0.02 - Release

  2003-06-26 - Allowed for setting the initial delay to 0 seconds, which 
    allows new users to run in a "learning only" mode where no emails
    will be tempfailed.  Also, if the initial delay is set to a negative
    number, the first delivery attempt of unknown triplets will be failed,
    but any subsequent attempts will be allowed (within other time limits).

  2003-06-26 - Added a new table to the database definition for reporting,
    and a new script to move expired entries to the reporting table to help
    keep the active table to a minimum size (for speed).

  2003-06-26 - Added a check to avoid greylisting checks if the mail client
    is authenticated with sendmail.  Suggested by Borja Perez.
    
  2003-06-26 - Minor comment changes.  Update to whitelist_ip.txt.

  2003-06-25 - Changed defaults in relaydelay.pl and relaydelay.conf to be
    58 minutes for initial timeout, with a 5 hour window.

  2003-06-25 - Added whitelist_ip.txt file to the sources, describing IPs
    and networks that most users of a Greylisting implementation will want.

0.01 - Initial Release

